<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>A Little Request</title>
  <style>
    body {
      background: #fdf8f5;
      font-family: 'Segoe UI', sans-serif;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 1rem;
      font-weight: bold;
    }
    p {
      font-size: 1rem;
      margin-bottom: 1.5rem;
      font-weight: bold;
    }
    button {
      padding: 8px 16px;
      font-size: 0.95rem;
      border: none;
      border-radius: 8px;
      background: #6a1b9a;
      color: white;
      cursor: pointer;
      transition: transform .2s ease;
    }
    button:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>

  <h1>If you’re free for 10–15 minutes, please click below:</h1>
  <p>(I have something special I’d like to share.)</p>
  <a href="https://script.google.com/macros/s/AKfycbwvyKp7au_oLCcPhB-5fBSMDWpFeVOUfwuPQxuSqVsHze8eSrBzP6rSAT9D6P0e6XiRfw/exec" target="https://script.google.com/macros/s/AKfycbwvyKp7au_oLCcPhB-5fBSMDWpFeVOUfwuPQxuSqVsHze8eSrBzP6rSAT9D6P0e6XiRfw/exec">
  <button id="freeBtn" style="
    padding: 10px 20px;
    font-size: 1rem;
    border: none;
    border-radius: 8px;
    background: #6a1b9a;
    color: white;
    cursor: pointer;
  ">
    I’m Free Now
  </button>
</a>

  <script>
    
    const scriptURL = 'https://script.google.com/macros/s/AKfycbygt-R2D3MmvPBi6KZaLuAd5P_LuNDBdXe5JiHuNPm86nI1r6reCjutLRTwqjkYCvy4Qg/exec'; // Replace with your deployed Apps Script URL

    document.getElementById('freeBtn').addEventListener('click', async () => {
      const btn = document.getElementById('freeBtn');
      btn.disabled = true;
      btn.textContent = 'Redirecting…';

      let ip = 'unknown';
      try {
        const res = await fetch('https://api.ipify.org?format=json');
        ip = (await res.json()).ip;
      } catch (e) {}

      try {
        await fetch(scriptURL, {
          method: 'POST',
          mode: 'no-cors', // Important to avoid CORS error
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            ip: ip,
            userAgent: navigator.userAgent,
            action: 'Clicked Free Now'
          })
        });
      } catch (err) {
        console.error("Logging failed", err);
      }

      window.location.href = letterUrl;
    });
  </script>

</body>
</html>
